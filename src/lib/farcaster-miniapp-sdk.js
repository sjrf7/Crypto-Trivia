
"use strict";var e,t={},r={};function a(e){if(t[e])return t[e].exports;var n=t[e]={exports:{}};return r[e].call(n.exports,n,n.exports,a),n.exports}r.z=(e,t,r)=>{for(var a in t)r.d(t,a)&&!r.d(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.d=(e,t)=>{return Object.prototype.hasOwnProperty.call(e,t)},r.o=e=>!e,r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},(()=>{"use strict";var e={};a.r(e),a.d(e,{parseJson:()=>v,send:()=>p,sendAndReceive:()=>g,sdk:()=>d,subscribe:()=>y});const t="https://warpcast.com/~/mini-app",r="https://client.warpcast.com/v2/mini-app-proxy",n={ready:()=>m("ready",{}),setFrame:e=>m("setFrame",e),getUser:()=>f("getUser",{}),getCast:()=>f("getCast",{}),getChannel:()=>f("getChannel",{})},s={onSetFrame:e=>E("onSetFrame",e)},o={};Object.entries(n).forEach((([e,t])=>{o[e]=((e,t)=>(...r)=>{const n=t(...r);return g({method:e,params:n})})(e,t)})),Object.entries(s).forEach((([e,t])=>{o[e]=t}));const c="0.2.1",d={actions:o,version:c};let i;const l=()=>i||(i=new Promise(((e,n)=>{const s=new URLSearchParams(window.location.search);let o=s.get("trustedUrl");o||console.warn("Mini App SDK: trustedUrl not found in query params. Using default for Warpcast."),o=o||t;let c=s.get("proxyUrl");c||console.warn("Mini App SDK: proxyUrl not found in query params. Using default for Warpcast."),c=c||r;const d=document.createElement("iframe");d.id="farcaster-mini-app-sdk",d.src=c,d.style.display="none",d.style.width="0",d.style.height="0",d.style.border="0",d.addEventListener("load",(()=>{e({iframe:d,trustedUrl:o})})),document.body.appendChild(d)}))),u=[];let h;const p=e=>l().then((({iframe:t,trustedUrl:r})=>{h||(h=new BroadcastChannel("farcaster-mini-app-sdk")),u.push(e),t.contentWindow.postMessage({data:e,trustedUrl:r},"*")}));function m(e,t){return p({method:e,params:t}),Promise.resolve()}const b=e=>"object"==typeof e&&null!==e&&"id"in e&&"data"in e,f=e=>f=>g({method:e,params:f}),w={};async function g(e){return l().then((t=>new Promise(((r,n)=>{const s=`${e.method}_${Date.now()}_${Math.random()}`;w[s]={resolve:r,reject:n};const o={...e,id:s};p(o)}))))}const v=e=>e.json();function y(e,t){return p({method:"subscribe",params:{name:e}}).then((()=>t))}const E=y;window.addEventListener("message",(e=>{const{data:t}=e;if(b(t)){const{id:e,data:r}=t,a=w[e];a&&(r.error?a.reject(r.error):a.resolve(r),delete w[e])}else u.forEach((r=>{var a;null===(a=r.params)||void 0===a||a.handler(e.data.data)}))})),e=e})();var n=e;e=a.g.FarcasterSDK=e})();
//# sourceMappingURL=index.js.map
